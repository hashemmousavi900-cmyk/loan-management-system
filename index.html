<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù…â€ŒÙ‡Ø§ - CR(Mashhad)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ... */
        
        .debug-panel {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            font-size: 12px;
        }
        
        .debug-panel h3 {
            margin-bottom: 10px;
            color: #495057;
        }
        
        .debug-info {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #e9ecef;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .debug-controls {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .debug-section {
            margin-bottom: 15px;
            padding: 10px;
            background: #e9ecef;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="table-responsive">
            <div class="table-wrapper">
                <div class="table-title">
                    <h2>Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù…â€ŒÙ‡Ø§ - CR(Mashhad)</h2>
                    <div class="btn-group">
                        <button class="btn btn-success" id="add-loan-btn">
                            <i class="fas fa-plus"></i> 
                            <span>Ø§ÙØ²ÙˆØ¯Ù† ÙˆØ§Ù… Ø¬Ø¯ÛŒØ¯</span>
                        </button>
                        <button class="btn btn-warning" id="export-excel">
                            <i class="fas fa-file-excel"></i>
                            <span>Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</span>
                        </button>
                        <button class="btn btn-info" id="save-to-cloud">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets</span>
                        </button>
                        <button class="btn btn-primary" id="load-from-cloud">
                            <i class="fas fa-cloud-download-alt"></i>
                            <span>Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² Google Sheets</span>
                        </button>
                        <button class="btn btn-secondary" id="test-connection-btn">
                            <i class="fas fa-wifi"></i>
                            <span>ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø·</span>
                        </button>
                        <button class="btn btn-danger" id="debug-btn">
                            <i class="fas fa-bug"></i>
                            <span>Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÛŒØ¨Ø§Ú¯</span>
                        </button>
                    </div>
                </div>
                
                <!-- Ù¾Ù†Ù„ Ø¯ÛŒØ¨Ø§Ú¯ -->
                <div id="debug-panel" class="debug-panel" style="display: none;">
                    <h3>ğŸ”§ Ù¾Ù†Ù„ Ø¯ÛŒØ¨Ø§Ú¯ Ùˆ ØªØ³Øª Ø³ÛŒØ³ØªÙ…</h3>
                    
                    <div class="debug-section">
                        <h4>ğŸ“Š ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…</h4>
                        <div class="debug-info" id="system-status">
                            Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...
                        </div>
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ“¨ Ù„Ø§Ú¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§</h4>
                        <div class="debug-info" id="request-logs">
                            Ù‡ÛŒÚ† Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡
                        </div>
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ’¾ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ</h4>
                        <div class="debug-info" id="current-data">
                            Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...
                        </div>
                    </div>
                    
                    <div class="debug-controls">
                        <button class="btn btn-secondary" id="test-save-btn">
                            <i class="fas fa-vial"></i> ØªØ³Øª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ
                        </button>
                        <button class="btn btn-warning" id="test-load-btn">
                            <i class="fas fa-sync"></i> ØªØ³Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                        </button>
                        <button class="btn btn-info" id="add-test-data-btn">
                            <i class="fas fa-plus-circle"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø¯Ø§Ø¯Ù‡ ØªØ³Øª
                        </button>
                        <button class="btn btn-danger" id="clear-all-btn">
                            <i class="fas fa-trash"></i> Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                        </button>
                        <button class="btn btn-success" id="force-save-btn">
                            <i class="fas fa-save"></i> Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¬Ø¨Ø§Ø±ÛŒ
                        </button>
                    </div>
                </div>

                <!-- Ø¨Ù‚ÛŒÙ‡ Ú©Ø¯Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ... -->
                
            </div>
        </div>
    </div>

    <!-- Ø¨Ù‚ÛŒÙ‡ Ú©Ø¯Ù‡Ø§ÛŒ HTML... -->

    <script>
        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        let sampleData = [];
        let isAuthenticated = false;
        let authExpiryTime = null;
        let pendingAction = null;
        let pendingEmployeeId = null;
        let isEditing = false;
        let requestLogs = [];
        
        const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbymE-RILJ8gCg4vLreCz5wchcQrx-mS5HzCmHEpuOu4RMl58Vma3rZlfJ_Ac1XUQzK0/exec';

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ù„Ø§Ú¯ Ú©Ø±Ø¯Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§
        function logRequest(action, data, response, error = null) {
            const log = {
                timestamp: new Date().toLocaleString('fa-IR'),
                action: action,
                data: data,
                response: response,
                error: error
            };
            
            requestLogs.unshift(log); // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø§Ø¨ØªØ¯Ø§ÛŒ Ø¢Ø±Ø§ÛŒÙ‡
            if (requestLogs.length > 10) {
                requestLogs = requestLogs.slice(0, 10); // Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† ÙÙ‚Ø· 10 Ù„Ø§Ú¯ Ø¢Ø®Ø±
            }
            
            updateDebugInfo();
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
            setupEventListeners();
            loadFromGoogleSheets();
            updateDebugInfo();
        });

        // Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Google Apps Script - Ù†Ø³Ø®Ù‡ Ø¯ÛŒØ¨Ø§Ú¯
        async function googleAppsScriptRequest(action, data = null) {
            console.log(`ğŸ“¡ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ${action}...`);
            
            const requestId = Date.now();
            const startTime = Date.now();
            
            return new Promise((resolve, reject) => {
                const callbackName = 'cb_' + requestId;
                
                let url = `${GOOGLE_APPS_SCRIPT_URL}?action=${action}&callback=${callbackName}`;
                
                if (data) {
                    url += `&data=${encodeURIComponent(JSON.stringify(data))}`;
                }
                
                url += `&t=${requestId}`;
                
                console.log('ğŸ”— URL Ø¯Ø±Ø®ÙˆØ§Ø³Øª:', url);
                
                window[callbackName] = function(response) {
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    
                    console.log(`ğŸ“¥ Ù¾Ø§Ø³Ø® Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯ (${duration}ms):`, response);
                    logRequest(action, data, response);
                    
                    delete window[callbackName];
                    if (script.parentNode) {
                        document.body.removeChild(script);
                    }
                    resolve(response);
                };
                
                const script = document.createElement('script');
                script.src = url;
                
                script.onerror = function() {
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    const error = new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª');
                    
                    console.error(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª (${duration}ms)`);
                    logRequest(action, data, null, error.message);
                    
                    delete window[callbackName];
                    if (script.parentNode) {
                        document.body.removeChild(script);
                    }
                    reject(error);
                };
                
                document.body.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        const error = new Error('ØªØ§ÛŒÙ…â€ŒØ§ÙˆØª Ø¯Ø±Ø®ÙˆØ§Ø³Øª');
                        console.error(`â° ØªØ§ÛŒÙ…â€ŒØ§ÙˆØª Ø¯Ø±Ø®ÙˆØ§Ø³Øª ${action} (15000ms)`);
                        logRequest(action, data, null, error.message);
                        
                        delete window[callbackName];
                        if (script.parentNode) {
                            document.body.removeChild(script);
                        }
                        reject(error);
                    }
                }, 15000);
            });
        }

        // ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ù¾ÛŒØ´Ø±ÙØªÙ‡
        async function advancedTestConnection() {
            showLoading(true, 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ù¾ÛŒØ´Ø±ÙØªÙ‡...');
            
            try {
                // ØªØ³Øª 1: ØªØ³Øª Ø³Ø§Ø¯Ù‡
                console.log('ğŸ§ª ØªØ³Øª 1: ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ø³Ø§Ø¯Ù‡');
                const test1 = await googleAppsScriptRequest('test');
                
                // ØªØ³Øª 2: ØªØ³Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡
                console.log('ğŸ§ª ØªØ³Øª 2: ØªØ³Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡');
                const test2 = await googleAppsScriptRequest('loadData');
                
                // ØªØ³Øª 3: ØªØ³Øª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÙˆÙ†Ù‡
                console.log('ğŸ§ª ØªØ³Øª 3: ØªØ³Øª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ');
                const testData = [{
                    Username: 'debug_user',
                    Employeenumber: 'DEBUG001',
                    Fullname: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª Ø¯ÛŒØ¨Ø§Ú¯',
                    Gender: 'Ù…Ø±Ø¯',
                    Bankloan: '10,000,000',
                    Companyloan: '5,000,000',
                    Bankloandate: '2024-01-01',
                    Companyloandate: '2024-01-01',
                    Priority: '2',
                    Description: 'Ø¯Ø§Ø¯Ù‡ ØªØ³Øª Ø¯ÛŒØ¨Ø§Ú¯',
                    Loanrequest: 'false'
                }];
                
                const test3 = await googleAppsScriptRequest('saveData', testData);
                
                showLoading(false);
                
                if (test1.success && test2.success && test3.success) {
                    showNotification('âœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
                } else {
                    showNotification('âš ï¸ Ø¨Ø±Ø®ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯Ù†Ø¯', 'warning');
                }
                
            } catch (error) {
                showLoading(false);
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø·', 'error');
                console.error('Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡:', error);
            }
        }

        // Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø¯ÛŒØ¨Ø§Ú¯ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        async function saveToGoogleSheetsWithDebug() {
            if (sampleData.length === 0) {
                console.log('âš ï¸ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                showNotification('Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'warning');
                return true;
            }
            
            console.log('ğŸ’¾ Ø´Ø±ÙˆØ¹ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø¯ÛŒØ¨Ø§Ú¯...');
            console.log('ğŸ“Š ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', sampleData.length);
            console.log('ğŸ“‹ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', sampleData);
            
            showLoading(true, 'Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets...');
            
            try {
                // ØªØ¨Ø¯ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ø³Ø§Ø®ØªØ§Ø± ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Google Sheets
                const dataForSheets = sampleData.map(item => ({
                    Username: item.username || '',
                    Employeenumber: item.employeeNumber,
                    Fullname: item.fullname,
                    Gender: item.gender,
                    Bankloan: item.bankLoan || '',
                    Companyloan: item.companyLoan || '',
                    Bankloandate: item.bankLoanDate || '',
                    Companyloandate: item.companyLoanDate || '',
                    Priority: item.priority,
                    Description: item.description || '',
                    Loanrequest: item.loanRequest ? 'true' : 'false'
                }));
                
                console.log('ğŸ“¤ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ø¨Ù‡ Google Sheets:', dataForSheets);
                
                const result = await googleAppsScriptRequest('saveData', dataForSheets);
                console.log('âœ… Ù¾Ø§Ø³Ø® Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ:', result);
                
                showLoading(false);
                
                if (result && result.success) {
                    saveToLocalStorage();
                    showNotification('ØªØºÛŒÛŒØ±Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Google Sheets Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.', 'success');
                    return true;
                } else {
                    throw new Error(result.error || 'Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ');
                }
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ:', error);
                showLoading(false);
                saveToLocalStorage();
                showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§ÙØ¸Ù‡ Ù…Ø­Ù„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.', 'warning');
                return false;
            }
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÛŒØ¨Ø§Ú¯
        function updateDebugInfo() {
            const systemStatus = document.getElementById('system-status');
            const requestLogsElement = document.getElementById('request-logs');
            const currentDataElement = document.getElementById('current-data');
            
            if (systemStatus) {
                systemStatus.innerHTML = `
Ø²Ù…Ø§Ù†: ${new Date().toLocaleString('fa-IR')}
ØªØ¹Ø¯Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§: ${sampleData.length}
ÙˆØ¶Ø¹ÛŒØª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª: ${isAuthenticated ? 'âœ… ÙØ¹Ø§Ù„' : 'âŒ ØºÛŒØ±ÙØ¹Ø§Ù„'}
Ø¢Ø¯Ø±Ø³ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª: ${GOOGLE_APPS_SCRIPT_URL}
Ø­Ø§ÙØ¸Ù‡ Ù…Ø­Ù„ÛŒ: ${localStorage.getItem('loanData') ? 'âœ… Ø¯Ø§Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡' : 'âŒ Ø®Ø§Ù„ÛŒ'}
                `.trim();
            }
            
            if (requestLogsElement) {
                if (requestLogs.length === 0) {
                    requestLogsElement.textContent = 'Ù‡ÛŒÚ† Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡';
                } else {
                    requestLogsElement.innerHTML = requestLogs.map(log => `
â° ${log.timestamp}
ğŸ¯ ${log.action}
${log.data ? `ğŸ“¦ Ø¯Ø§Ø¯Ù‡: ${JSON.stringify(log.data).substring(0, 100)}...` : ''}
${log.response ? `âœ… Ù¾Ø§Ø³Ø®: ${JSON.stringify(log.response)}` : ''}
${log.error ? `âŒ Ø®Ø·Ø§: ${log.error}` : ''}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    `).join('');
                }
            }
            
            if (currentDataElement) {
                currentDataElement.textContent = JSON.stringify(sampleData, null, 2);
            }
        }

        // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯
        function setupDebugEventListeners() {
            const debugBtn = document.getElementById('debug-btn');
            if (debugBtn) {
                debugBtn.addEventListener('click', function() {
                    const debugPanel = document.getElementById('debug-panel');
                    debugPanel.style.display = debugPanel.style.display === 'none' ? 'block' : 'none';
                    updateDebugInfo();
                });
            }

            const testSaveBtn = document.getElementById('test-save-btn');
            if (testSaveBtn) {
                testSaveBtn.addEventListener('click', function() {
                    saveToGoogleSheetsWithDebug();
                });
            }

            const testLoadBtn = document.getElementById('test-load-btn');
            if (testLoadBtn) {
                testLoadBtn.addEventListener('click', function() {
                    loadFromGoogleSheets();
                });
            }

            const addTestDataBtn = document.getElementById('add-test-data-btn');
            if (addTestDataBtn) {
                addTestDataBtn.addEventListener('click', function() {
                    const testData = {
                        username: 'debug_user_' + Date.now(),
                        employeeNumber: 'DEBUG' + Date.now(),
                        fullname: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª Ø¯ÛŒØ¨Ø§Ú¯',
                        gender: 'Ù…Ø±Ø¯',
                        bankLoan: '10,000,000',
                        companyLoan: '5,000,000',
                        bankLoanDate: '2024-01-01',
                        companyLoanDate: '2024-01-01',
                        priority: '2',
                        description: 'Ø§ÛŒÙ† ÛŒÚ© Ø±Ú©ÙˆØ±Ø¯ ØªØ³Øª Ø¯ÛŒØ¨Ø§Ú¯ Ø§Ø³Øª',
                        loanRequest: false
                    };
                    
                    sampleData.push(testData);
                    renderTable(sampleData);
                    saveToLocalStorage();
                    showNotification('Ø¯Ø§Ø¯Ù‡ ØªØ³Øª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'success');
                    updateDebugInfo();
                });
            }

            const clearAllBtn = document.getElementById('clear-all-btn');
            if (clearAllBtn) {
                clearAllBtn.addEventListener('click', function() {
                    if (confirm('âš ï¸ Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                        sampleData = [];
                        localStorage.removeItem('loanData');
                        renderTable(sampleData);
                        showNotification('Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'success');
                        updateDebugInfo();
                    }
                });
            }

            const forceSaveBtn = document.getElementById('force-save-btn');
            if (forceSaveBtn) {
                forceSaveBtn.addEventListener('click', function() {
                    saveToGoogleSheetsWithDebug();
                });
            }
        }

        // Ø§ØµÙ„Ø§Ø­ setupEventListeners Ø¨Ø±Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯ÛŒØ¨Ø§Ú¯
        function setupEventListeners() {
            // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ...
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯
            setupDebugEventListeners();
            
            const testConnectionBtn = document.getElementById('test-connection-btn');
            if (testConnectionBtn) {
                testConnectionBtn.addEventListener('click', function() {
                    advancedTestConnection();
                });
            }

            const saveToCloud = document.getElementById('save-to-cloud');
            if (saveToCloud) {
                saveToCloud.addEventListener('click', function() {
                    saveToGoogleSheetsWithDebug();
                });
            }

            // Ø¨Ù‚ÛŒÙ‡ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§...
        }

        // ØªÙˆØ§Ø¨Ø¹ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ø¨Ø§ Ù†Ø³Ø®Ù‡ Ø¯ÛŒØ¨Ø§Ú¯ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†
        async function saveToGoogleSheets() {
            return await saveToGoogleSheetsWithDebug();
        }

        // Ø¨Ù‚ÛŒÙ‡ ØªÙˆØ§Ø¨Ø¹ Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„...

    </script>
</body>
</html>
